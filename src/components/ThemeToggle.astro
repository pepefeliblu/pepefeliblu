---
import { Sun, Moon } from "lucide-astro";
---

<button id="theme-toggle" aria-label="Toggle dark mode">
    <Sun class="sun-icon" />
    <Moon class="moon-icon" />
</button>

<style>
    #theme-toggle {
        background: none;
        border: none;
        cursor: pointer;
        padding: 0;
        margin-left: 1.5rem;
        color: var(--color-text-secondary);
        transition: color 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    #theme-toggle:hover {
        color: var(--color-accent);
    }

    .sun-icon,
    .moon-icon {
        width: 20px;
        height: 20px;
    }

    /* Default state: Show Sun (Light Mode implied), Hide Moon */
    /* This logic will be inverted by global CSS based on .dark class */
    .moon-icon {
        display: none;
    }

    /* When dark mode is active (html.dark), show Moon, hide Sun */
    :global(html.dark) .sun-icon {
        display: none;
    }

    :global(html.dark) .moon-icon {
        display: block;
    }
</style>

<script>
    const handleToggleClick = () => {
        const element = document.documentElement;
        element.classList.toggle("dark");

        const isDark = element.classList.contains("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
    };

    const toggle = document.getElementById("theme-toggle");
    if (toggle) {
        toggle.addEventListener("click", handleToggleClick);
    }
</script>
